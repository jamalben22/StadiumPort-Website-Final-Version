name: Lighthouse Performance Audits

on:
  workflow_dispatch:
  schedule:
    - cron: '30 2 * * *'

jobs:
  audit:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Node
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      - name: Run Lighthouse CI
        uses: treosh/lighthouse-ci-action@v10
        with:
          urls: |
            ${{ secrets.SITE_URL }}/
            ${{ secrets.SITE_URL }}/world-cup-2026-host-cities/new-york-new-jersey
            ${{ secrets.SITE_URL }}/world-cup-2026-stadiums/metlife-stadium
            ${{ secrets.SITE_URL }}/world-cup-2026-travel-tips/ultimate-world-cup-2026-packing-guide
            ${{ secrets.SITE_URL }}/transportation/new-york-new-jersey-world-cup-2026-your-complete-getting-around-guide
            ${{ secrets.SITE_URL }}/world-cup-2026-stadiums
            ${{ secrets.SITE_URL }}/world-cup-2026-host-cities
          uploadArtifacts: true
          temporaryPublicStorage: true
          configPath: .lighthouse/desktop-config.json

      - name: Summarize results
        run: |
          echo "Lighthouse audits completed. Artifacts attached to this run."